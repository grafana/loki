{{- with .Values.monitoring.dashboards }}
{{- if .enabled }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "loki.dashboardsName" $ }}-1
  namespace: {{ .namespace | default $.Release.Namespace }}
  labels:
    {{- include "loki.labels" $ | nindent 4 }}
    {{- with .labels }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
  {{- with .annotations }}
  annotations:
    {{- toYaml . | nindent 4 }}
  {{- end }}
data:
  {{- $prefix := "ssd" }}
  {{- if "loki.deployment.isDistributed "}}
  {{- $prefix = "distributed" }}
  {{- end -}}

  # "loki-chunks.json": |
  #   {{ $.Files.Get (printf "src/dashboards/%s/loki-chunks.json" $prefix) | fromJson | toJson }}
  # TODO: why does this one fails?
  # "loki-deletion.json": |
  #   {{ $.Files.Get (printf "src/dashboards/%s/loki-deletion.json" $prefix) | fromJson | toJson }}
  # "loki-logs.json": |
  #   {{ $.Files.Get (printf "src/dashboards/%s/loki-logs.json" $prefix) | fromJson | toJson }}
  # "loki-mixin-recording-rules.json": |
  #   {{ $.Files.Get (printf "src/dashboards/%s/loki-mixin-recording-rules.json" $prefix) | fromJson | toJson }}
  # "loki-operational.json": |
  #   {{ $.Files.Get (printf "src/dashboards/%s/loki-operational.json" $prefix) | fromJson | toJson }}
{{- end -}}
{{- end -}}
