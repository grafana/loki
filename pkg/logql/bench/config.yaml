# Loki configuration file for reading data from the logql benchmark dataset.
# Run Loki from the project root
#   $ make loki
#   $ ./cmd/loki/loki -config.file=./pkg/logql/bench/config.yaml -config.expand-env=true
#
# Folder layout generated by the benchmark tool:
#
# data
# ├── storage
# │   ├── dataobj
# │   │   ├── index
# │   │   │   └── v0
# │   │   │       ├── indexes
# │   │   │       │   └── 33
# │   │   │       └── tocs
# │   │   ├── objects
# │   │   │   ├── 10
# │   │   │   ├── ..
# │   │   │   └── ce
# │   │   └── tocs
# │   ├── index
# │   │   └── index_19723
# │   └── test-tenant
# │       ├── 1167f1bd2bcde088
# │       ├── ...
# │       └── ff9868d673bb8ef1
# └── workingdir
#     ├── cache
#     └── tsdb-shipper-active
#         ├── multitenant
#         │   └── index_19723
#         ├── per_tenant
#         ├── scratch
#         │   └── filesystem_-292275055-05-16
#         ├── uploader
#         └── wal
#             └── filesystem_-292275055-05-16

auth_enabled: true

server:
  http_listen_port: 3100
  grpc_listen_port: 9095
  log_level: info

common:
  compactor_address: 127.0.0.1
  instance_addr: 127.0.0.1
  path_prefix: ${PWD}/pkg/logql/bench/data/workingdir
  replication_factor: 1
  ring:
    kvstore:
      store: inmemory

limits_config:
  tsdb_max_query_parallelism: 1
  tsdb_sharding_strategy: power_of_two
  tsdb_max_bytes_per_shard: 128MB
  allow_structured_metadata: true
  query_timeout: 1h
  split_queries_by_interval: 1h
  ingestion_rate_mb: 100

schema_config:
  configs:
    - from: 2020-01-01
      store: tsdb
      object_store: filesystem
      schema: v13
      index:
        path_prefix: index/
        prefix: index_
        period: 24h

storage_config:
  use_thanos_objstore: true
  object_store:
    filesystem:
      dir: ${PWD}/pkg/logql/bench/data/storage

query_engine:
  enable: true
  batch_size: 8192

query_range:
  cache_results: false

dataobj:
  storage_bucket_prefix: "dataobj"

tracing:
  enabled: false

analytics:
 reporting_enabled: false

ui:
  enabled: true
  goldfish:
    enable: false
