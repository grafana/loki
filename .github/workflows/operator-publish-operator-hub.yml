name: "Publish release on operator hub"
on:
  release:
    types: [published]

jobs:
  operator-hub-prod-release:
    if: startsWith(github.event.release.tag_name, 'operator/')
    uses: ./.github/workflows/reusable-operator-hub-release.yaml
    with:
      org: redhat-openshift-ecosystem
      repo: community-operators-prod
    secrets:
      GRAFANABOT_GITHUB_TOKEN: ${{ secrets.GRAFANABOT_GITHUB_TOKEN }}

  operator-hub-community-release:
    if: startsWith(github.event.release.tag_name, 'operator/')
    uses: ./.github/workflows/reusable-operator-hub-release.yaml
    with:
      org: k8s-operatorhub
      repo: community-operators
    secrets:
      GRAFANABOT_GITHUB_TOKEN: ${{ secrets.GRAFANABOT_GITHUB_TOKEN }}
